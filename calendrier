import requests
from ics import Calendar

# URL du flux iCal public (remplace par l'URL exacte de ton calendrier)
ICAL_URL = "https://calendar.google.com/calendar/ical/consortium.ariane%40gmail.com/public/basic.ics"

# T√©l√©charger le fichier iCal
response = requests.get(ICAL_URL)
if response.status_code == 200:
    cal = Calendar(response.text)
    
    # Dictionnaire pour stocker les √©v√©nements selon leur pr√©fixe
    events_by_category = {}

    # Parcourir les √©v√©nements du calendrier
    for event in cal.events:
        title = event.name  # Nom de l'√©v√©nement
        start = event.begin  # Date et heure de d√©but

        # D√©terminer la cat√©gorie en fonction du nom (exemple : pr√©fixes "R√©union", "Atelier", etc.)
        category = title.split(" ")[0]  # Premier mot du titre comme cat√©gorie

        # Ajouter l'√©v√©nement √† la bonne cat√©gorie
        if category not in events_by_category:
            events_by_category[category] = []
        events_by_category[category].append({"title": title, "start": start})

    # Afficher le tri des √©v√©nements
    for category, events in events_by_category.items():
        print(f"\nüìå Cat√©gorie : {category}")
        for e in events:
            print(f"  - {e['title']} ({e['start']})")
else:
    print("‚ùå Impossible de r√©cup√©rer le calendrier")
